[{"title":"Objective-C id as Swift Any","date":"2017-02-09T06:29:00.000Z","path":"2017/02/09/objective-c-id-as-swift-any/","text":"Swift3 æ¥å£å’ŒObjective-C çš„APIsæ¯”ä¹‹å‰çš„ç‰ˆæœ¬æ›´å¼ºå¤§ã€‚ä¾‹å¦‚ï¼ŒSwift 2å°†Objective-Cä¸­çš„idç±»å‹æ˜ å°„åˆ°Swiftä¸­çš„AnyObjectç±»å‹ï¼Œé€šå¸¸åªèƒ½ä¿å­˜å€¼ç±»å‹ã€‚ Swift 2è¿˜ä¸ºAnyObjectæä¾›äº†å¯¹ä¸€äº›æ¡¥æ¥å€¼ç±»å‹ï¼ˆä¾‹å¦‚Stringï¼ŒArrayï¼ŒDictionaryï¼ŒSetå’Œä¸€äº›æ•°å­—ï¼‰çš„éšå¼è½¬æ¢ï¼Œä»¥ä¾¿åŸç”ŸSwiftç±»å‹å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨Cocoa APIsï¼Œå¦‚NSStringï¼ŒNSArrayæˆ–Foundationçš„å…¶ä»–å®¹å™¨ç±»ã€‚è¿™äº›è½¬æ¢ä¸è¯­è¨€çš„å…¶ä»–éƒ¨åˆ†ä¸ä¸€è‡´ï¼Œä½¿å¾—å¾ˆéš¾ç†è§£ä»€ä¹ˆå¯ä»¥ç”¨ä½œAnyObjectï¼Œç»“æœæ˜¯bugsã€‚ åœ¨Swift 3ä¸­ï¼ŒObjective-Cä¸­çš„idç±»å‹ç°åœ¨æ˜ å°„åˆ°Swiftä¸­çš„Anyç±»å‹ï¼Œå®ƒæè¿°äº†ä»»ä½•ç±»å‹çš„å€¼ï¼Œæ— è®ºæ˜¯ç±»ï¼Œæšä¸¾ï¼Œç»“æ„è¿˜æ˜¯ä»»ä½•å…¶ä»–Swiftç±»å‹ã€‚è¿™ç§å˜åŒ–ä½¿å¾—Swiftä¸­çš„Objective-C APIsæ›´åŠ çµæ´»ï¼Œå› ä¸ºSwiftå®šä¹‰çš„å€¼ç±»å‹å¯ä»¥ä¼ é€’ç»™Objective-C APIï¼Œå¹¶ä½œä¸ºSwiftç±»å‹è¿”å›ï¼Œä»è€Œæ— éœ€æ‰‹åŠ¨â€œboxâ€ç±»å‹ã€‚è¿™äº›ä¼˜ç‚¹ä¹Ÿæ‰©å±•åˆ°é›†åˆï¼šObjective-Cé›†åˆç±»å‹NSArrayï¼ŒNSDictionaryå’ŒNSSetï¼Œä»¥å‰åªæ¥å—AnyObjectçš„å…ƒç´ ï¼Œç°åœ¨å¯ä»¥ä¿å­˜Anyç±»å‹çš„å…ƒç´ ã€‚å¯¹äºæ•£åˆ—å®¹å™¨ï¼Œä¾‹å¦‚Dictionaryå’ŒSetï¼Œæœ‰ä¸€ä¸ªæ–°ç±»å‹AnyHashableå¯ä»¥å®¹çº³ä»»ä½•ç±»å‹çš„å€¼éµå¾ªSwift Hashableåè®®ã€‚æ€»ä¹‹ï¼Œä»Swift 2åˆ°Swift 3ä»¥ä¸‹ç±»å‹æ˜ å°„æ›´æ”¹ä¸ºï¼š Objective-C Swift2 Swift3 id AnyObject Any NSArray * [AnyObject] [Any] NSDictionary * [NSObject: AnyObject] [AnyHashable: Any] NSSet * Set Set åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ‚¨çš„ä»£ç ä¸å¿…ä¸ºå“åº”æ­¤æ›´æ”¹è€Œæ˜¾ç€åœ°æ›´æ”¹ã€‚ Swift 2ä¸­çš„ä»£ç ä¾èµ–äºéšå¼è½¬æ¢ä¸ºAnyObjectçš„å€¼ç±»å‹ï¼Œå®ƒå°†ç»§ç»­æŒ‰ç…§Anyçš„åŸæ ·åœ¨Swift 3ä¸­å·¥ä½œã€‚ä½†æ˜¯ï¼Œæœ‰äº›åœ°æ–¹éœ€è¦æ›´æ”¹å£°æ˜çš„å˜é‡å’Œæ–¹æ³•ç±»å‹ï¼Œå¹¶è·å¾—Swift 3çš„æœ€ä½³ä½“éªŒã€‚å¦å¤–ï¼Œå¦‚æœä½ çš„ä»£ç æ˜¾å¼ä½¿ç”¨AnyObjectæˆ–Cocoaç±»ï¼Œå¦‚NSStringï¼ŒNSArrayæˆ–NSDictionaryï¼Œä½ å°†éœ€è¦å¼•å…¥æ›´å¤šçš„æ˜¾å¼è½¬æ¢ä½¿ç”¨as NSStringæˆ–as Stringï¼Œå› ä¸ºåœ¨Swift 3ä¸­å¯¹è±¡å’Œå€¼ç±»å‹ä¹‹é—´çš„éšå¼è½¬æ¢ä¸å†å…è®¸ã€‚Xcodeä¸­çš„è‡ªåŠ¨è¿ç§»å™¨å°†è¿›è¡Œæœ€å°çš„æ›´æ”¹ï¼Œä»¥ä¿æŒæ‚¨çš„ä»£ç ä»Swift 2åˆ°3ç¼–è¯‘ï¼Œä½†ç»“æœå¯èƒ½ä¸æ€»æ˜¯æœ€ä¼˜é›…çš„ã€‚æœ¬æ–‡å°†ä»‹ç»æ‚¨å¯èƒ½éœ€è¦åšçš„ä¸€äº›æ›´æ”¹ï¼Œä»¥åŠåœ¨æ›´æ”¹ä»£ç ä»¥å……åˆ†åˆ©ç”¨idä¸ºAnyæ—¶éœ€è¦æ³¨æ„çš„ä¸€äº›é™·é˜±ã€‚ è¦†ç›–æ–¹æ³•å’Œéµå¾ªåè®®å½“å­ç±»åŒ–ä¸€ä¸ªObjective-Cç±»å¹¶è¦†ç›–å®ƒçš„æ–¹æ³•ï¼Œæˆ–è€…éµå¾ªä¸€ä¸ªObjective-Cåè®®ï¼Œå½“çˆ¶æ–¹æ³•åœ¨Objective-Cä¸­ä½¿ç”¨idæ—¶ï¼Œéœ€è¦æ›´æ–°æ–¹æ³•çš„ç±»å‹ã€‚ä¸€äº›å¸¸è§çš„ä¾‹å­æ˜¯NSObjectç±»çš„isEqualï¼šæ–¹æ³•å’ŒNSCopyingåè®®çš„copyWithZoneï¼šæ–¹æ³•ã€‚åœ¨Swift 2ä¸­ï¼Œä½ å°†å†™ä¸€ä¸ªéµå¾ªNSCopyingçš„NSObjectå­ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345// Swift 2class Foo: NSObject, NSCopying &#123; override func isEqual(_ x: AnyObject?) -&gt; Bool &#123; ... &#125; func copyWithZone(_ zone: NSZone?) -&gt; AnyObject &#123; ... &#125;&#125; åœ¨Swift 3ä¸­ï¼Œé™¤äº†å°†å‘½åä»copyWithZoneï¼ˆ_ :)æ›´æ”¹ä¸ºcopyï¼ˆwith :)ä¹‹å¤–ï¼Œè¿˜éœ€è¦å°†è¿™äº›æ–¹æ³•çš„ç­¾åæ›´æ”¹ä¸ºAnyè€Œä¸æ˜¯AnyObjectï¼š 12345// Swift 3class Foo: NSObject, NSCopying &#123; override func isEqual(_ x: Any?) -&gt; Bool &#123; ... &#125; func copy(with zone: NSZone?) -&gt; Any &#123; ... &#125;&#125; éç±»å‹é›†åˆå±æ€§åˆ—è¡¨ï¼ŒJSONå’Œç”¨æˆ·ä¿¡æ¯å­—å…¸åœ¨Cocoaä¸­å¾ˆå¸¸è§ï¼ŒCocoaæœ¬åœ°å°†è¿™äº›è¡¨ç¤ºä¸ºéç±»å‹åŒ–é›†åˆã€‚åœ¨Swift 2ä¸­ï¼Œä¸ºæ­¤éœ€è¦æ„å»ºArrayï¼ŒDictionaryæˆ–Set with AnyObjectæˆ–NSObjectå…ƒç´ ï¼Œä¾é éšå¼æ¡¥æ¥è½¬æ¢æ¥å¤„ç†å€¼ç±»å‹ï¼š 12345678910111213141516171819202122// Swift 2struct State &#123; var name: String var abbreviation: String var population: Int var asPropertyList: [NSObject: AnyObject] &#123; var result: [NSObject: AnyObject] = [:] // Implicit conversions turn String into NSString hereâ€¦ result[\"name\"] = self.name result[\"abbreviation\"] = self.abbreviation // â€¦and Int into NSNumber here. result[\"population\"] = self.population return result &#125;&#125;let california = State(name: \"California\", abbreviation: \"CA\", population: 39_000_000)NSNotification(name: \"foo\", object: nil, userInfo: california.asPropertyList) æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Cocoaå®¹å™¨ç±»ï¼Œä¾‹å¦‚NSDictionaryï¼š 12345678910111213141516171819202122// Swift 2struct State &#123; var name: String var abbreviation: String var population: Int var asPropertyList: NSDictionary &#123; var result = NSMutableDictionary() // Implicit conversions turn String into NSString hereâ€¦ result[\"name\"] = self.name result[\"abbreviation\"] = self.abbreviation // â€¦and Int into NSNumber here. result[\"population\"] = self.population return result.copy() &#125;&#125;let california = State(name: \"California\", abbreviation: \"CA\", population: 39_000_000)// NSDictionary then implicitly converts to [NSObject: AnyObject] here.NSNotification(name: \"foo\", object: nil, userInfo: california.asPropertyList) åœ¨Swift 3ä¸­ï¼Œéšå¼è½¬æ¢å·²ç»æ¶ˆå¤±ï¼Œå› æ­¤ä¸Šè¿°ä¸¤ä¸ªç‰‡æ®µéƒ½ä¸ä¼šæŒ‰åŸæ ·å·¥ä½œã€‚è¿ç§»è€…å¯èƒ½å»ºè®®ç”¨aså•ç‹¬è½¬æ¢æ¯ä¸ªå€¼ï¼Œä»¥ä¿æŒæ­¤ä»£ç çš„å·¥ä½œï¼Œä½†æœ‰ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ Swiftç°åœ¨å¯¼å…¥Cocoa APIæ¥å—Anyå’Œ/æˆ–AnyHashableçš„é›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ›´æ”¹é›†åˆç±»å‹ä¸º[AnyHashableï¼šAny]æ›¿æ¢[NSObjectï¼šAnyObject]æˆ–NSDictionaryï¼Œè€Œä¸æ›´æ”¹ä»»ä½•å…¶ä»–ä»£ç ï¼š 1234567891011121314151617181920212223// Swift 3struct State &#123; var name: String var abbreviation: String var population: Int // Change the dictionary type to [AnyHashable: Any] here... var asPropertyList: [AnyHashable: Any] &#123; var result: [AnyHashable: Any] = [:] // No implicit conversions necessary, since String and Int are subtypes // of Any and AnyHashable result[\"name\"] = self.name result[\"abbreviation\"] = self.abbreviation result[\"population\"] = self.population return result &#125;&#125;let california = State(name: \"California\", abbreviation: \"CA\", population: 39_000_000)// ...and you can still use it with Cocoa API hereNotification(name: \"foo\", object: nil, userInfo: california.asPropertyList) AnyHashableç±»å‹Swiftçš„Anyç±»å‹å¯ä»¥ä¿å­˜ä»»ä½•ç±»å‹ï¼Œä½†æ˜¯Dictionaryå’ŒSetéœ€è¦çš„é”®æ˜¯Hashableï¼Œæ‰€ä»¥Anyæ˜¯å¤ªæ™®é€šã€‚ä»Swift 3å¼€å§‹ï¼ŒSwiftæ ‡å‡†åº“æä¾›äº†ä¸€ä¸ªæ–°çš„ç±»å‹AnyHashableã€‚ä¸Anyç±»ä¼¼ï¼Œå®ƒå……å½“æ‰€æœ‰Hashableç±»å‹çš„çˆ¶ç±»å‹ï¼Œå› æ­¤Stringï¼ŒIntå’Œå…¶ä»–hashableç±»å‹çš„å€¼å¯ä»¥éšå¼åœ°ç”¨AnyHashableå€¼ï¼ŒAnyHashableä¸­çš„ç±»å‹å¯ä»¥ä½¿ç”¨isï¼Œas!æˆ–as?åŠ¨æ€æ£€æŸ¥ï¼ŒåŠ¨æ€è½¬æ¢è¿ç®—ç¬¦ã€‚å½“ä»Objective-Cå¯¼å…¥æ— ç±»å‹çš„NSDictionaryæˆ–NSSetå¯¹è±¡æ—¶ï¼Œä½¿ç”¨AnyHashableï¼Œä½†æ˜¯åœ¨çº¯Swiftä¸­ä¹Ÿå¯ç”¨äºæ„å»ºå¼‚æ„é›†åˆæˆ–å­—å…¸ã€‚ æœªé“¾æ¥ä¸Šä¸‹æ–‡çš„æ˜¾å¼è½¬æ¢åœ¨æŸäº›æœ‰é™çš„æƒ…å†µä¸‹ï¼ŒSwiftä¸èƒ½è‡ªåŠ¨æ¡¥æ¥Cå’ŒObjective-Cæ„é€ ã€‚ä¾‹å¦‚ï¼Œä¸€äº›Cå’ŒCocoa APIä½¿ç”¨id * æŒ‡é’ˆä½œä¸ºâ€œoutâ€æˆ–â€œin-outâ€å‚æ•°ï¼Œå¹¶ä¸”ç”±äºSwiftä¸èƒ½é™æ€åœ°ç¡®å®šæŒ‡é’ˆçš„ä½¿ç”¨æ–¹å¼ï¼Œå› æ­¤å®ƒä¸èƒ½å¯¹å†…å­˜ä¸­çš„å€¼è‡ªåŠ¨æ‰§è¡Œæ¡¥æ¥è½¬æ¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŒ‡é’ˆä»å°†æ˜¾ç¤ºä¸ºUnsafePointer ã€‚å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨è¿™äº›éæ¡¥æ¥APIï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ˜¾å¼æ¡¥æ¥è½¬æ¢ï¼Œåœ¨ä»£ç ä¸­ä½¿ç”¨as Typeæˆ–as AnyObjectæ˜¾å¼ç¼–å†™ã€‚ 1234567// ObjC@interface Foo- (void)updateString:(NSString *)string;- (void)updateObject:(id *)obj;@end 123456789101112// Swiftfunc interactWith(foo: Foo) -&gt; (String, Any) &#123; var string = \"string\" as NSString // explicit conversion foo.updateString(&amp;string) // parameter imports as UnsafeMutablePointer&lt;NSString&gt; let finishedString = string as String var object = \"string\" as AnyObject foo.updateObject(&amp;object) // parameter imports as UnsafeMutablePointer&lt;AnyObject&gt; let finishedObject = object as Any return (finishedString, finishedObject)&#125; å¦å¤–ï¼ŒObjective-Cåè®®åœ¨Swiftä¸­ä»ç„¶æ˜¯ç±»çº¦æŸï¼Œæ‰€ä»¥ä½ ä¸èƒ½è®©Swiftç»“æ„æˆ–æšä¸¾ç›´æ¥éµå¾ªObjective-Cåè®®æˆ–è€…ä½¿ç”¨è½»é‡çº§é€šç”¨ç±»ã€‚æ‚¨éœ€è¦ä½¿ç”¨è¿™äº›åè®®å’ŒAPIæ˜¾å¼è½¬æ¢String as NSStringï¼ŒArray as NSArrayç­‰ã€‚ AnyObjectæˆå‘˜æŸ¥æ‰¾Anyæ²¡æœ‰ä¸AnyObjectç›¸åŒçš„é­”æ³•æ–¹æ³•æŸ¥æ‰¾è¡Œä¸ºã€‚è¿™å¯èƒ½ä¼šç ´åä¸€äº›Swift 2ä»£ç ï¼ŒæŸ¥æ‰¾å±æ€§æˆ–å‘é€æ¶ˆæ¯åˆ°ä¸€ä¸ªæ— ç±»å‹çš„Objective-Cå¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ªSwift 2çš„ä»£ç ï¼š 12345// Swift 2func foo(x: NSArray) &#123; // Invokes -description by magic AnyObject lookup print(x[0].description)&#125; å°†æŠ±æ€¨descriptionä¸æ˜¯Swift 3ä¸­Anyçš„æˆå‘˜ã€‚å¯ä»¥å°†x [0] as AnyObjectä»¥è·å–åŠ¨æ€è¡Œä¸ºï¼š 12345// Swift 3func foo(x: NSArray) &#123; // Result of subscript is now Any, needs to be coerced to get method lookup print((x[0] as AnyObject).description)&#125; æˆ–è€…ï¼Œå°†å€¼å¼ºåˆ¶è½¬æ¢ä¸ºæ‚¨æœŸæœ›çš„å…·ä½“å¯¹è±¡ç±»å‹ï¼š 1234func foo(x: NSArray) &#123; // Cast to the concrete object type you expect print((x[0] as! NSObject).description)&#125; Swiftä¸­çš„å€¼ç±»å‹Anyå¯ä»¥holdä½ä»»ä½•ç»“æ„ï¼Œæšä¸¾ï¼Œå…ƒç»„æˆ–ä½ å¯ä»¥åœ¨è¯­è¨€ä¸­å®šä¹‰çš„å…¶ä»–Swiftç±»å‹ã€‚ Swift 3ä¸­çš„Objective-Cæ¡¥æ¥å™¨å¯ä»¥æä¾›ä»»ä½•Swiftå€¼ä½œä¸ºObjective-Cçš„idå…¼å®¹å¯¹è±¡ã€‚è¿™ä½¿å¾—æ›´å®¹æ˜“åœ¨Cocoaå®¹å™¨ï¼ŒuserInfoå­—å…¸å’Œå…¶ä»–å¯¹è±¡ä¸­å­˜å‚¨è‡ªå®šä¹‰Swiftå€¼ç±»å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨Swift 2ä¸­ï¼Œæ‚¨éœ€è¦å°†æ•°æ®ç±»å‹æ›´æ”¹ä¸ºç±»ï¼Œæˆ–è€…æ‰‹åŠ¨boxå®ƒä»¬ï¼Œä»¥å°†å®ƒä»¬çš„å€¼é™„åŠ åˆ°NSNotificationï¼š 1234567891011121314151617// Swift 2struct CreditCard &#123; number: UInt64, expiration: NSDate &#125;let PaymentMade = \"PaymentMade\"// We can't attach CreditCard directly to the notification, since it// isn't a class, and doesn't bridge.// Wrap it in a Box class.class Box&lt;T&gt; &#123; let value: T init(value: T) &#123; self.value = value &#125;&#125;let paymentNotification = NSNotification(name: PaymentMade, object: Box(value: CreditCard(number: 1234_0000_0000_0000, expiration: NSDate()))) ä½¿ç”¨Swift 3ï¼Œæˆ‘ä»¬å¯ä»¥å–æ¶ˆboxï¼Œå¹¶å°†å¯¹è±¡ç›´æ¥é™„åŠ åˆ°Notificationï¼š 12345678// Swift 3let PaymentMade = Notification.Name(\"PaymentMade\")// We can associate the CreditCard value directly with the Notificationlet paymentNotification = Notification(name: PaymentMade, object: CreditCard(number: 1234_0000_0000_0000, expiration: Date())) åœ¨Objective-Cä¸­ï¼ŒCreditCardå€¼å°†ä½œä¸ºä¸€ä¸ªidå…¼å®¹çš„ï¼Œç»§æ‰¿NSObjectå¯¹è±¡å®ç°isEqualï¼šï¼Œhashå’Œdescriptionï¼Œå¦‚æœå®ƒä»¬å­˜åœ¨åŸç”Ÿçš„Swiftç±»å‹çš„è¯ï¼Œä½¿ç”¨Swiftçš„Equatableï¼ŒHashableå’ŒCustomStringConvertibleã€‚ä»Swiftä¸­ï¼Œå¯ä»¥é€šè¿‡å°†å…¶åŠ¨æ€åœ°è½¬æ¢å›å…¶åŸå§‹ç±»å‹æ¥æ£€ç´¢è¯¥å€¼ï¼š 123// Swift 3let paymentCard = paymentNotification.object as! CreditCardprint(paymentCard.number) // 1234000000000000 è¯·æ³¨æ„ï¼Œåœ¨Swift 3.0ä¸­ï¼Œä¸€äº›å¸¸è§çš„Swiftå’ŒObjective-Cç»“æ„ç±»å‹å°†æ¡¥æ¥ä¸ºä¸é€æ˜å¯¹è±¡ï¼Œè€Œä¸æ˜¯æƒ¯ç”¨çš„Cocoaå¯¹è±¡ã€‚ä¾‹å¦‚ï¼ŒIntï¼ŒUIntï¼ŒDoubleå’ŒBoolæ¡¥æ¥åˆ°NSNumberï¼Œå…¶ä»–å¤§å°çš„æ•°å­—ç±»å‹ï¼Œä¾‹å¦‚Int8ï¼ŒUInt16ç­‰åªæ¡¥æ¥ä¸ºä¸é€æ˜å¯¹è±¡ã€‚å¯å˜ç»“æ„å¦‚CGRectï¼ŒCGPointå’ŒCGSizeä¹Ÿä½œä¸ºä¸é€æ˜å¯¹è±¡æ¡¥æ¥ï¼Œå³ä½¿å¤§å¤šæ•°Cocoa APIæœŸæœ›å®ƒä»¬ä¸€èµ·ä½œä¸ºå¯¹è±¡åœ¨NSValueå®ä¾‹ä¸­è¢«boxã€‚å¦‚æœä½ çœ‹åˆ°unrecognized selector sent to _SwiftValueé”™è¯¯ï¼Œè¿™è¡¨æ˜Objective-Cä»£ç è¯•å›¾è°ƒç”¨ä¸€ä¸ªä¸é€æ˜çš„Swiftå€¼ç±»å‹çš„æ–¹æ³•ï¼Œä½ å¯èƒ½éœ€è¦æ‰‹åŠ¨boxè¯¥ç±»çš„å®ä¾‹ä¸­Objective-Cä»£ç æœŸæœ›çš„å€¼ã€‚ è¦æ³¨æ„çš„ä¸€ä¸ªç‰¹æ®Šé—®é¢˜æ˜¯Optionalsã€‚ Swift Anyå¯ä»¥ä»£è¡¨ä»»ä½•ä¸œè¥¿ï¼ŒåŒ…æ‹¬ä¸€ä¸ªOptionalï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä¸é¦–å…ˆæ£€æŸ¥å®ƒæƒ…å†µä¸‹å°†ä¸€ä¸ªåŒ…è£…çš„Optionalä¼ é€’ç»™Objective-C APIï¼Œå³ä½¿APIè¢«å£°æ˜ä¸ºä¸€ä¸ªnonnull idç±»å‹ã€‚è¿™é€šå¸¸è¡¨ç°ä¸ºåŒ…æ‹¬_SwiftValueçš„è¿è¡Œæ—¶é”™è¯¯ï¼Œè€Œä¸æ˜¯ç¼–è¯‘æ—¶é”™è¯¯ã€‚ Xcode 8.1 betaä¸­åŒ…å«çš„Swift 3.0.1é€šè¿‡å®ç°è¿™äº›å»ºè®®æ¥é€æ˜åœ°å¤„ç†æ•°å­—ç±»å‹ï¼ŒObjective-Cç»“æ„å’Œå¯é€‰ç±»å‹ï¼Œä»¥è§£å†³NSNumberï¼ŒNSValueå’ŒOptionalæ¡¥æ¥ä¸­çš„ä¸Šè¿°é™åˆ¶ï¼š SEâ€“0139: Bridge Numeric Types to NSNumber and Cocoa Structs to NSValue SEâ€“0140: Warn when Optional converts to Any, and bridge Optional As Its Payload Or NSNull ä¸ºäº†é¿å…å‘å‰å…¼å®¹æ€§é—®é¢˜ï¼Œä½ ä¸åº”è¯¥ä¾èµ–_SwiftValueç±»çš„ä¸é€æ˜å¯¹è±¡çš„å®ç°ç»†èŠ‚ï¼Œå› ä¸ºæœªæ¥ç‰ˆæœ¬çš„Swiftå¯èƒ½å…è®¸æ›´å¤šçš„Swiftç±»å‹æ¡¥æ¥åˆ°æƒ¯ç”¨çš„Objective-Cç±»ã€‚ Linuxå¯ç§»æ¤æ€§åœ¨Linuxä¸Šä½¿ç”¨Swift Core è¿è¡Œçš„Swiftç¨‹åºåº“ä½¿ç”¨äº†åŸç”ŸSwiftä¸­ç¼–å†™çš„ä¸€ä¸ªFoundationç‰ˆæœ¬ï¼Œæ²¡æœ‰Objective-Cè¿è¡Œæ—¶æ¡¥æ¥ã€‚ id-as-Anyå…è®¸Core Librariesç›´æ¥ä½¿ç”¨åŸç”ŸSwift Anyå’Œæ ‡å‡†åº“å€¼ç±»å‹ï¼ŒåŒæ—¶ä½¿ç”¨Objective-C Foundationå®ç°ä¿æŒä¸Appleå¹³å°ä¸Šçš„ä»£ç å…¼å®¹ã€‚ç”±äºSwiftåœ¨Linuxä¸Šä¸ä¸Objective-Cäº¤äº’æ“ä½œï¼Œå› æ­¤ä¸æ”¯æŒæ¡¥æ¥è½¬æ¢ï¼Œä¾‹å¦‚string as NSStringæˆ–value as AnyObjectã€‚å¸Œæœ›åœ¨Cocoaå’ŒSwift Core Librariesä¹‹é—´ç§»æ¤çš„Swiftä»£ç åº”è¯¥åªä½¿ç”¨å€¼ç±»å‹ã€‚ å­¦ä¹ æ›´å¤šid-as-Anyæ˜¯Swiftè¯­è¨€æ”¹è¿›çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå—åˆ°ç”¨æˆ·å¯¹æ—©æœŸç‰ˆæœ¬çš„Swiftçš„åé¦ˆçš„å¯å‘ï¼Œå¹¶é€šè¿‡æ¥è‡ªå¼€æ”¾çš„Swift Evolutionè¿‡ç¨‹çš„å›é¡¾å®Œå–„ã€‚å¦‚æœä½ æƒ³æ›´å¤šåœ°äº†è§£id-as-AnyèƒŒåçš„åŠ¨æœºå’Œè®¾è®¡å†³ç­–ï¼ŒåŸå§‹çš„Swift Evolutionæè®®å¯ä»¥åœ¨GitHubçš„swift-evolutionä»“åº“ä¸­æ‰¾åˆ°ï¼š SE-0072ï¼šå®Œå…¨æ¶ˆé™¤æ¥è‡ªSwiftçš„éšå¼æ¡¥æ¥è½¬æ¢ SE-0116ï¼šå°†Objective-C **id**å¯¼å…¥ä¸ºSwift**Any**ç±»å‹ SE-0131ï¼šå°†AnyHashableæ·»åŠ åˆ°æ ‡å‡†åº“ æœ€ç»ˆç»“æœæ˜¯ï¼ŒSwiftæ˜¯ä¸€ç§æ›´åŠ ä¸€è‡´çš„è¯­è¨€ï¼Œå½“ä½¿ç”¨Swiftæ—¶ï¼ŒCocoa APIå˜å¾—æ›´å¼ºå¤§ã€‚","tags":[]},{"title":"Unit Testing","date":"2016-12-21T09:58:16.000Z","path":"2016/12/21/unit-testing/","text":"12341.Testing Framework Review2.High-level Overview3.Time to Testing4.Whatâ€™s new?(Asynchronous Testing, Performance Testing) 12345Xcodeâ€™s testing frameworks Xcode5: OCUnit -&gt; XCTestXcode5.1: OCUnit Xcode6: new XCTest API 12test class name end with Tests.(e:ViewModelTests)test case methods must start with the word test so that the test runner can find them.(e:testInitialization) 12345XCTestCaseThe default XCTestCase class contains a setup() and a tearDown() method.For every test function, the test runner calls setup() and tearDown()Override these methods to perform any necessary configuration of your object before the test runs, and any cleanup after. 1234567891011121314151617181920AssertionsXCTFail(formatâ€¦) ç”Ÿæˆä¸€ä¸ªå¤±è´¥çš„æµ‹è¯•ï¼› XCTAssertNil(a1, format...)ä¸ºç©ºåˆ¤æ–­ï¼Œa1ä¸ºç©ºæ—¶é€šè¿‡ï¼Œåä¹‹ä¸é€šè¿‡ï¼› XCTAssertNotNil(a1, formatâ€¦)ä¸ä¸ºç©ºåˆ¤æ–­ï¼Œa1ä¸ä¸ºç©ºæ—¶é€šè¿‡ï¼Œåä¹‹ä¸é€šè¿‡ï¼›XCTAssert(expression, format...)å½“expressionæ±‚å€¼ä¸ºTRUEæ—¶é€šè¿‡ï¼› XCTAssertTrue(expression, format...)å½“expressionæ±‚å€¼ä¸ºTRUEæ—¶é€šè¿‡ï¼› XCTAssertFalse(expression, format...)å½“expressionæ±‚å€¼ä¸ºFalseæ—¶é€šè¿‡ï¼› XCTAssertEqualObjects(a1, a2, format...)åˆ¤æ–­ç›¸ç­‰ï¼Œ[a1 isEqual:a2]å€¼ä¸ºTRUEæ—¶é€šè¿‡ï¼Œå…¶ä¸­ä¸€ä¸ªä¸ä¸ºç©ºæ—¶ï¼Œä¸é€šè¿‡ï¼›XCTAssertNotEqualObjects(a1, a2, format...)åˆ¤æ–­ä¸ç­‰ï¼Œ[a1 isEqual:a2]å€¼ä¸ºFalseæ—¶é€šè¿‡ï¼›XCTAssertEqual(a1, a2, format...)åˆ¤æ–­ç›¸ç­‰ï¼ˆå½“a1å’Œa2æ˜¯ Cè¯­è¨€æ ‡é‡ã€ç»“æ„ä½“æˆ–è”åˆä½“æ—¶ä½¿ç”¨,å®é™…æµ‹è¯•å‘ç°NSStringä¹Ÿå¯ä»¥ï¼‰ï¼› XCTAssertNotEqual(a1, a2, format...)åˆ¤æ–­ä¸ç­‰ï¼ˆå½“a1å’Œa2æ˜¯ Cè¯­è¨€æ ‡é‡ã€ç»“æ„ä½“æˆ–è”åˆä½“æ—¶ä½¿ç”¨ï¼‰ï¼›XCTAssertEqualWithAccuracy(a1, a2, accuracy, format...)åˆ¤æ–­ç›¸ç­‰ï¼Œï¼ˆdoubleæˆ–floatç±»å‹ï¼‰æä¾›ä¸€ä¸ªè¯¯å·®èŒƒå›´ï¼Œå½“åœ¨è¯¯å·®èŒƒå›´ï¼ˆ+/-accuracyï¼‰ä»¥å†…ç›¸ç­‰æ—¶é€šè¿‡æµ‹è¯•ï¼› XCTAssertNotEqualWithAccuracy(a1, a2, accuracy, format...) åˆ¤æ–­ä¸ç­‰ï¼Œï¼ˆdoubleæˆ–floatç±»å‹ï¼‰æä¾›ä¸€ä¸ªè¯¯å·®èŒƒå›´ï¼Œå½“åœ¨è¯¯å·®èŒƒå›´ä»¥å†…ä¸ç­‰æ—¶é€šè¿‡æµ‹è¯•ï¼› XCTAssertThrows(expression, format...)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionå‘ç”Ÿå¼‚å¸¸æ—¶é€šè¿‡ï¼›åä¹‹ä¸é€šè¿‡ï¼›ï¼ˆå¾ˆå˜æ€ï¼‰ XCTAssertThrowsSpecific(expression, specificException, format...) å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionå‘ç”ŸspecificExceptionå¼‚å¸¸æ—¶é€šè¿‡ï¼›åä¹‹å‘ç”Ÿå…¶ä»–å¼‚å¸¸æˆ–ä¸å‘ç”Ÿå¼‚å¸¸å‡ä¸é€šè¿‡ï¼› XCTAssertThrowsSpecificNamed(expression, specificException, exception_name, format...)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionå‘ç”Ÿå…·ä½“å¼‚å¸¸ã€å…·ä½“å¼‚å¸¸åç§°çš„å¼‚å¸¸æ—¶é€šè¿‡æµ‹è¯•ï¼Œåä¹‹ä¸é€šè¿‡ï¼› XCTAssertNoThrow(expression, formatâ€¦)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionæ²¡æœ‰å‘ç”Ÿå¼‚å¸¸æ—¶é€šè¿‡æµ‹è¯•ï¼›XCTAssertNoThrowSpecific(expression, specificException, format...)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionæ²¡æœ‰å‘ç”Ÿå…·ä½“å¼‚å¸¸ã€å…·ä½“å¼‚å¸¸åç§°çš„å¼‚å¸¸æ—¶é€šè¿‡æµ‹è¯•ï¼Œåä¹‹ä¸é€šè¿‡ï¼› XCTAssertNoThrowSpecificNamed(expression, specificException, exception_name, format...)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionæ²¡æœ‰å‘ç”Ÿå…·ä½“å¼‚å¸¸ã€å…·ä½“å¼‚å¸¸åç§°çš„å¼‚å¸¸æ—¶é€šè¿‡æµ‹è¯•ï¼Œåä¹‹ä¸é€šè¿‡ 123456Asynchronous TestingPerformance TestingmeasureBlock: which takes a block of code and measures the execution time of the entire block.measureMetrics: is a more intimate version of measureBlock that offers fine grained control of what to measure,and when to measure it. 12345678910How Xcode decides to mark a performance test as success or failure, hereâ€™s the logicFor convenience AVE means average,STDDEV means standard deviation:1. If the test has no baseline, the result is neither a success nor a failure.2. If the current runâ€™s STDDEV minus the baseline STDDEV took less than 0.1 second, ignore it.3. If the current run&apos;s STDDEV minus the baseline STDDEV took more than 0.1 second and the difference is more than 10%, itâ€™s a failure.4. If the current runâ€™s AVE minus the baseline AVE took less than 0.1 second, ignore it.5. If the current runâ€™s AVE minus the baseline AVE took more than 0.1 second and the difference is more than 10%, itâ€™s a failure.6. Everything else is considered a success.","tags":[]},{"title":"äº§å“ äº§å“","date":"2016-12-20T09:52:09.000Z","path":"2016/12/20/äº§å“-äº§å“/","text":"äº§å“çš„è¿­ä»£éœ€è¦æœ‰è®¡åˆ’ï¼Œæœ‰ç­–ç•¥çš„è¿›è¡Œã€‚å°±åƒä¸‹è±¡æ£‹ä¸€æ ·ï¼Œæ‰¿å‰å¯åï¼Œæ‰“å‡ºç»„åˆæ‹³ã€‚æ‰èƒ½è¾¾åˆ°ç›®æ ‡ã€‚","tags":[{"name":"è¿­ä»£","slug":"è¿­ä»£","permalink":"http://yoursite.com/tags/è¿­ä»£/"}]},{"title":"Swift-Objective-Cåˆ°åº•å“ªå®¶å¼º","date":"2016-08-22T07:44:42.000Z","path":"2016/08/22/Swift-Objective-Cåˆ°åº•å“ªå®¶å¼º/","text":"swiftå‡ºä¸–åï¼Œäººä»¬èŒ¶ä½™é¥­åå°±ä¼šè®¨è®ºSwiftå’ŒOCåˆ°åº•å“ªå®¶å¼ºï¼ŸSwiftå¥½ç”¨å—ï¼Ÿä¸‹é¢ä¸»è¦ä»ç”¨æ³•å’Œæ€§èƒ½æ–¹é¢æ¥è®¨è®ºã€‚ è¯­æ³• æ¯«æ— ç–‘é—®ï¼Œä»ç¬¬ä¸€çœ¼çœ‹åˆ°Swiftã€‚å°±çœ‹åˆ°äº†å®ƒçš„ç®€æ´ï¼Œè¯­æ³•æ›´æ¸…æ¥šï¼Œæ›´å®¹æ˜“è¢«ç†è§£ã€‚è¿™è¦å½’ç»“äºSwiftçš„è®¾è®¡ï¼Œå®ƒå€Ÿé‰´äº†å¾ˆå¤šè¯­è¨€ï¼ˆCã€JavaScriptã€Pythonã€Javaï¼‰çš„ä¼˜ç‚¹ï¼Œç‰¹åˆ«æ˜¯åŠ¨æ€è¯­è¨€ã€‚è®©ä½ å†™èµ·æ¥æ›´ç®€å•æœ‰è¶£ã€‚åŒæ—¶ï¼ŒSwiftä¹Ÿæä¾›äº†é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚ æ€§èƒ½ æµ‹è¯•å¹³å°ï¼šMacMini 2.6 GHz Intel Core i5ï¼Œ Xcode8.2ï¼ŒSwift3.0 å¾ªç¯å¾ªç¯ä¸€ç™¾ä¸‡æ¬¡ï¼Œé‡Œé¢ä»€ä¹ˆäº‹ä¹Ÿä¸åš swift 12345678910111213let oneMillion = 1000000let startTimes = NSDate().timeIntervalSince1970 * 1000func loop() &#123; for _ in 1...oneMillion &#123; &#125;&#125;loop()let endTimes = NSDate().timeIntervalSince1970 * 1000let usedTimes = endTimes - startTimesprint(\"loop a million times used \\(usedTimes) ms\") OC 12345678910int oneMillion = 1000000;NSTimeInterval startTimes = [[NSDate date] timeIntervalSince1970] * 1000;for (NSUInteger i = 0; i &lt; oneMillion; i++)&#123;&#125;NSTimeInterval endTimes = [[NSDate date] timeIntervalSince1970] * 1000;NSTimeInterval usedTimes = endTimes - startTimes;printf(\"used times %f ms\", usedTimes); ç”¨æ—¶ï¼ˆè¿è¡Œåæ¬¡å–å¹³å‡å€¼ï¼‰Swiftï¼š 3.62075195msï¼ˆ3.333984375, 3.486083984375, 5.197998046875, 3.31982421875, 3.321044921875,3.31982421875, 3.338134765625, 4.220947265625, 3.32177734375, 3.347900390625,ï¼‰Objective-Cï¼š2.4488037ms (2.345947, 2.363037, 2.292725, 2.596924, 2.352051,2.587158, 2.348145, 2.649902, 2.412109, 2.540039,) å¿«é€Ÿæ’åº å¿«é€Ÿæ’åºå°±å–10kä¸ªæ•°ï¼Œåˆ†ä¸ºä¸‰ç§æƒ…å†µï¼ˆæ­£å¸¸ï¼Œå€’åºï¼Œå‡å€¼ï¼‰ æ­£å¸¸swift 123456789101112131415161718192021222324252627let count = 10000let arr = Array(1...count)let startTimes = NSDate().timeIntervalSince1970 * 1000// *** Simple but inefficient version of quicksort ***func quicksort&lt;T: Comparable&gt;(_ a: [T]) -&gt; [T] &#123; guard a.count &gt; 1 else &#123; return a &#125; let pivot = a[a.count/2] let less = a.filter &#123; $0 &lt; pivot &#125; let equal = a.filter &#123; $0 == pivot &#125; let greater = a.filter &#123; $0 &gt; pivot &#125; // Uncomment this following line to see in detail what the // pivot is in each step and how the subarrays are partitioned. //print(pivot, less, equal, greater) return quicksort(less) + equal + quicksort(greater) return quicksort(less) + equal + quicksort(greater)&#125;quicksort(arr)let endTimes = NSDate().timeIntervalSince1970 * 1000let usedTimes = endTimes - startTimesprint(\"times used \\(usedTimes) ms\") OC 12345678910111213141516NSUInteger cap = 10000;NSMutableArray *arr = [NSMutableArray arrayWithCapacity:cap];for (NSUInteger i = 0; i &lt; cap; i++) &#123; NSNumber *num = [NSNumber numberWithInteger:i]; arr[i] =num;&#125;NSTimeInterval startTimes = [[NSDate date] timeIntervalSince1970] * 1000;[self QuickSorkOC:arr Count:[arr count]];NSTimeInterval endTimes = [[NSDate date] timeIntervalSince1970] * 1000;NSTimeInterval usedTimes = endTimes - startTimes;printf(\"used times %f ms\", usedTimes); ç”¨æ—¶ï¼ˆè¿è¡Œåæ¬¡å–å¹³å‡å€¼ï¼‰Swiftï¼š 201.352221msï¼ˆ226.079833984375, 180.364990234375, 182.054931640625, 195.965087890625, 197.198974609375,193.84375, 268.726806640625, 191.621826171875, 188.782958984375, 188.883056640625,ï¼‰Objective-Cï¼š1551.05075ms (1497.709961, 1507.664062, 1505.760254, 1498.334961, 1578.202148,1499.712158, 1531.479736, 1492.811035, 1684.247070, 1714.586182) å€’åºè€ƒè™‘æœ€åçš„æƒ…å†µï¼Œæ•°æ®æ˜¯ä»å¤§åˆ°å°çš„ã€‚åªéœ€è¦æŠŠæ•°ç»„å€’åºè¿‡æ¥ swift 12var arr = Array(1...count)arr.sort(by: &gt;) OC 1arr = (NSMutableArray *)[[arr reverseObjectEnumerator] allObjects]; ç”¨æ—¶ï¼ˆè¿è¡Œåæ¬¡å–å¹³å‡å€¼ï¼‰Swiftï¼š 193.266601msï¼ˆ184.419189453125, 255.409912109375, 189.22509765625, 198.416259765625, 190.2978515625,181.308837890625, 187.583984375, 184.344970703125, 183.385009765625, 178.27490234375,ï¼‰Objective-Cï¼š1644.0257ms(1911.626709, 1546.142090, 1542.587158, 1929.552979, 1553.895020,1576.763672, 1586.454102, 1558.053955, 1548.708252, 1686.473145,) å‡å€¼swift 12let count = 10000var arr = Array(repeating: 0, count: count) OC 1234for (NSUInteger i = 0; i &lt; cap; i++) &#123; NSNumber *num = [NSNumber numberWithInteger:0]; arr[i] = num;&#125; ç”¨æ—¶ï¼ˆè¿è¡Œåæ¬¡å–å¹³å‡å€¼ï¼‰Swiftï¼š 16.3355224msï¼ˆ13.64892578125, 21.63916015625, 15.175048828125, 21.05322265625, 17.60595703125,13.64111328125, 17.98193359375, 13.454833984375, 14.905029296875, 14.25, ï¼‰Objective-Cï¼š 10.8430176ms (18.000977, 10.387207, 10.093994, 10.768066, 9.725098,10.739014, 10.843018, 12.367188, 16.007812, 10.340820, ) å†…å­˜ç®¡ç† Swiftä¹Ÿæ˜¯é‡‡ç”¨äº†è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼ˆARCï¼‰æ¥ç®¡ç†å†…å­˜ï¼Œè¿™æ ·å¯ä»¥æ˜¯ç¨‹åºå‘˜ä¸“æ³¨äºæ ¸å¿ƒçš„åº”ç”¨é€»è¾‘ä»¥åŠæ–°çš„åŠŸèƒ½ç‰¹æ€§ä¸Šã€‚æŠŠå†…å­˜ç®¡ç†äº¤ç»™ç¼–è¯‘å™¨å»åšã€‚ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¦é¿å…å¾ªç¯å¼•ç”¨é€ æˆçš„å†…å­˜æ³„æ¼ã€‚ å®‰å…¨ ç”¨OCçš„æ—¶å€™ï¼Œæ¯”è¾ƒç»å¸¸é‡åˆ°çš„å´©æºƒæ˜¯ç©ºæŒ‡é’ˆï¼ˆnilã€nullï¼‰å’Œæ•°ç»„è¶Šç•Œã€‚åœ¨OCä¸­ä½ å¯¹nilå‘é€æ¶ˆæ¯ï¼Œæ˜¯è¢«å…è®¸çš„ï¼Œå®ƒä»€ä¹ˆäº‹æƒ…éƒ½ä¸ä¼šå‘ç”Ÿã€‚è€Œè¿™å°±æ˜¯å¾—çœ‹èµ·æ¥å¹¶ä¸ä¼šå´©æºƒï¼Œä½†å…¶å®å®ƒéšè—ç€ä¸€ä¸ªå·¨å¤§çš„bugã€‚è¿™ç§bugæ˜¯éšæœºçš„ï¼Œå¹¶ä¸”å¾ˆèƒ½å¤ç°ã€‚è¿™å°±é€ æˆåœ¨ä¿®å¤çš„æ—¶å€™å¿…é¡»å‘å¤§åŠ›æ°”æ¥å¯»æ‰¾é—®é¢˜æ‰€åœ¨ã€‚ åœ¨Swiftä¸­æä¾›äº†å¯é€‰ç±»å‹ä½¿å¾—ä¸€ä¸ªnilå¯é€‰å€¼çš„å¯èƒ½æ€§å˜å¾—éå¸¸çš„æ˜ç¡®ï¼Œè¿™æ ·ä½ å°±å¾ˆæ˜ç™½äº†ã€‚å¦‚æœä½ ä¸å°å¿ƒå†™äº†ä¸æ˜ç¡®çš„ä»£ç æ—¶ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚é—®é¢˜å°±åœ¨ç¼–å†™çš„æ—¶å€™å°±ä¿®å¤å¥½äº†ï¼Œè¿™å°±å¤§å¤§èŠ‚çœäº†ä¿®å¤OCæŒ‡é’ˆé€»è¾‘çš„bugæ—¶é—´ã€‚ ç»´æŠ¤ å†å²é—ç•™ä¸‹æ¥çš„é—®é¢˜ï¼Œä½¿å¾—OCä¸å¾—ä¸ç”¨ä¸¤ä¸ªæ–‡ä»¶ã€‚å¦‚æœCæ²¡æœ‰æ”¹è¿›çš„è¯ï¼ŒOCä¹Ÿå°±æ²¡åŠæ³•è·Ÿç€æ”¹å˜ã€‚åœ¨OCä¸­ï¼Œä¼˜åŒ–æ„å»ºçš„æ—¶é—´ä»¥åŠåˆ›å»ºAppçš„æ•ˆç‡å°±æ¯”ä¸ä¸ŠSwiftäº†ã€‚OCçš„ä¸¤ä»½æ–‡ä»¶ç³»ç»Ÿå°±å¤šäº†é¢å¤–çš„å·¥ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨ç»´æŠ¤çš„æ—¶å€™ï¼Œä¸å¾—ä¸æ¥å›çš„åˆ‡æ¢ï¼Œå¹¸å¥½æœ‰å¿«æ·é”®ï¼Œä½†ä¹Ÿä¼šè§‰å¾—ç¹çã€‚ BTWï¼šè‰¯å¥½çš„ç¼–ç¨‹è§„èŒƒæ˜¯å¾ˆé‡è¦çš„ å¥½ä¸å¥½ç”¨ï¼Ÿç”¨äº†æ‰çŸ¥é“ï¼Œè¯­è¨€å®ƒåªæ˜¯ä¸ªè¡¨ç°æ‰‹æ³•ï¼Œç¼–ç¨‹æ€æƒ³æ‰æ˜¯æœ€é‡è¦çš„ã€‚é€‚åˆå›¢é˜Ÿçš„å¼€å‘å·¥å…·ï¼Œèƒ½å¤Ÿé«˜æ•ˆçš„å·¥ä½œæ‰æ˜¯é¦–é€‰ï¼","tags":[{"name":"swift,","slug":"swift","permalink":"http://yoursite.com/tags/swift/"}]},{"title":"App-storeè½¬è®©App","date":"2015-08-22T07:44:42.000Z","path":"2015/08/22/App-storeè½¬è®©App/","text":"æœ‰æ—¶å€™éœ€è¦è½¬è®©Appåˆ°åˆ«çš„è´¦å·ä¸‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åªæœ‰ç¬¦åˆæ¡ä»¶çš„Appæ‰èƒ½è½¬è®©ã€‚ç”±äºApp storeé‡Œé¢åº”ç”¨åå­—çš„å”¯ä¸€æ€§ï¼Œå½“ä½ æ–°å»ºäº†åº”ç”¨è¿˜æ²¡æ¥å¾—æ€¥ä¸Šä¼ ï¼Œæƒ³æŠŠå®ƒè¿‡åº¦åˆ°å¦å¤–è´¦å·ä¸‹åªèƒ½ç­‰ç¬¬ä¸€ä¸ªç‰ˆæœ¬å®¡æ ¸é€šè¿‡åæ‰èƒ½æ“ä½œã€‚ ç¬¦åˆæ¡ä»¶çš„æ‰è¡Œ å¡«å†™è´¦å· Team IDåœ¨è¿™ åŒæ„å°±è¡Œ ç™»å½•å¦ä¸€ä¸ªè´¦å· å¡«å†™ä¿¡æ¯ï¼Œæ¥æ”¶å°±å¯ä»¥äº†ã€‚åº”ç”¨é©¬ä¸Šå°±è¿‡æ¥äº†ï¼Œä½†App storeä¸Šçš„ä¿¡æ¯è¿˜è¦ç­‰apple æœåŠ¡å™¨åŒæ­¥æ‰è¡Œã€‚","tags":[{"name":"iTunesconnect,","slug":"itunesconnect","permalink":"http://yoursite.com/tags/itunesconnect/"}]},{"title":"Cornerstone ignore UserInterfaceState.xcuserstate","date":"2014-11-21T09:18:44.000Z","path":"2014/11/21/Cornerstone-ignore-UserInterfaceState.xcuserstate/","text":"åœ¨æ§åˆ¶å° cd åˆ°é¡¹ç›®ç›®å½•ä¸‹svn -v status æŸ¥çœ‹æ–‡ä»¶çš„çŠ¶æ€(M): M 33769 33757 xxx XXX.xcworkspace/xcuserdata/XXX.xcuserdatad/UserInterfaceState.xcuserstate svn delete --keep-local --force xcuserdata/user.xcuserdatad/UserInterfaceState.xcuserstate æ­¤æ—¶ï¼ŒCornerstoneä¼šæ˜¾ç¤ºå®ƒçš„çŠ¶æ€ä¸ºâ€ï¼Ÿâ€,å³é”®Ignoreã€‚è§£å†³äº†ï¼Œä¸–ç•Œæ¸…é™äº†:] PS:added .xcuserstate to the Global Ignores (Cornerstone -&gt; Preferences -&gt; Subversion -&gt; turn off Use default global ignores -&gt; add â€œ\\.xcuserstateâ€)","tags":[{"name":"xcode","slug":"xcode","permalink":"http://yoursite.com/tags/xcode/"},{"name":"svn","slug":"svn","permalink":"http://yoursite.com/tags/svn/"},{"name":"tutorial","slug":"tutorial","permalink":"http://yoursite.com/tags/tutorial/"}]},{"title":"Swiftç¬”è®°","date":"2014-08-22T07:44:42.000Z","path":"2014/08/22/swiftç¬”è®°/","text":"swiftå‡ºä¸–æ—¶ï¼Œæ–­æ–­ç»­ç»­çœ‹äº†ä¸€äº›ã€‚åœ¨PlayGroundè€äº†è€è¿˜æ˜¯æŒºå¥½ç©çš„:]æœ‰OCä½œä¸ºåŸºç¡€ï¼Œä¸Šæ‰‹swiftè¿˜æ˜¯æŒºå¿«çš„ã€‚ä½†æ˜¯æœ‰ä¸€äº›è¯­æ³•è¿˜æ˜¯è¦ç•™æ„ä¸‹ã€‚è¿™ä¸ªå°±ä½œä¸ºå­¦ä¹ ç¬”è®°å§ï¼Œè®°å½•å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ³¨æ„ç‚¹ã€‚swiftå®˜ç½‘The Swift Programming Language if nilåœ¨OCä¸­æˆ‘ä»¬åœ¨åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯ä¸æ˜¯nilæ—¶ï¼Œä¸€èˆ¬å°±æ˜¯123NSString *values = @\"\";if(values) &#123;&#125; ä½†åœ¨swiftä¸­ï¼Œæ˜¯ä¼šæŠ¥é”™çš„12345var apple = \"apple\"if apple &#123; print(apple)&#125;//'String' is not convertible to 'Bool' Apple åœ¨GuidedTourä¸­å†™é“ï¼šIn an if statement, the conditional must be a Boolean expressionâ€”this means that code such as if score { â€¦ } is an error, not an implicit comparison to zero. You can use if and let together to work with values that might be missing. These values are represented as optionals. An optional value either contains a value or contains nil to indicate that a value is missing. Write a question mark (?) after the type of a value to mark the value as optional. æ­£ç¡®çš„å†™æ³•12345678var optionalString: String? = nilprint(optionalString == nil)if let str = optionalString &#123; print(str)&#125; else &#123; print(\"optionalString is nil\")&#125; è¿™æ ·å†™ä¹Ÿå¯ä»¥123456789var optionalString: String? = \"janes\"print(optionalString == nil)let isBool = (optionalString == nil)if isBool &#123; print(\"optionalString is nil \\(isBool)\")&#125; else &#123; print(\"optionalString is not nil\")&#125; ###12let sortedNumbers = numbers.sort &#123; $0 &gt; $1 &#125;print(sortedNumbers)","tags":[{"name":"swift,","slug":"swift","permalink":"http://yoursite.com/tags/swift/"}]},{"title":"iOS Crash Logå¤„ç†","date":"2014-06-24T06:02:36.000Z","path":"2014/06/24/ios-crash-logå¤„ç†/","text":"iOS crash log å¤„ç† ä»€ä¹ˆæ˜¯å´©æºƒæ—¥å¿—ï¼Œä»å“ªé‡Œèƒ½å¾—å®ƒ? iOSè®¾å¤‡ä¸Šçš„åº”ç”¨é—ªé€€æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªå´©æºƒæŠ¥å‘Šï¼Œä¹Ÿå«å´©æºƒæ—¥å¿—ï¼Œä¿å­˜åœ¨è®¾å¤‡ä¸Šã€‚ 1234Device LogsCrashReporter ~/Library/Logs/CrashReporter/MobileDevice/iTunes Connect -&gt; Crash Reportsç”¨æˆ· ä»€ä¹ˆæƒ…å†µä¸‹ä¼šäº§ç”Ÿå´©æºƒæ—¥å¿—? ä¸¤ç§ä¸»è¦æƒ…å†µä¼šäº§ç”Ÿå´©æºƒæ—¥å¿—: 1. åº”ç”¨è¿åæ“ä½œç³»ç»Ÿè§„åˆ™ã€‚ 2. åº”ç”¨ä¸­æœ‰Bugã€‚ Array.map12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970Incident Identifier: CE5E9C4A-A13D-4734-8483-97D55825AB57CrashReporter Key: d3adfba37a68e78e6885adfe06034f2798cf0762Hardware Model: iPhone6,1Process: XiaoYu [447]Path: /var/mobile/Applications/20FA34C5-0EC1-4692-A89E-1DC7C818C013/XiaoYu.app/XiaoYuIdentifier: com.rt.FISH4iPhoneVersion: 3.0.0 (3.0.0)Code Type: ARM (Native)Parent Process: launchd [1]Date/Time: 2014-06-20 18:32:00.417 +0800OS Version: iOS 7.1.1 (11D201)Report Version: 104Exception Type: EXC_CRASH (SIGABRT)Exception Codes: 0x0000000000000000, 0x0000000000000000Triggered by Thread: 0Last Exception Backtrace:(0x2fa3ef0b 0x3a1d1ce7 0x2fa3ee4d 0x54af09 0x3a7e971b 0x3a7ee7b7 0x3a736ff9 0x3a7add25 0x3a1d83a9 0x322a6857 0x3a1e0b6b 0x2f96f185 0x31ee933d 0x31eee7c7 0x3a1e0b6b 0x2f96f185 0x31ef0e11 0x3a6bad3f 0x3a6bd6c3 0x2fa09681 0x2fa07f4d 0x2f972769 0x2f97254b 0x348cf6d3 0x322d1891 0x233c79 0x3a6cfab7)Thread 0 Crashed:Last Exception Backtrace:(0x2fa3ef0b 0x3a1d1ce7 0x2fa3ee4d 0x54af09 0x3a7e971b 0x3a7ee7b7 0x3a736ff9 0x3a7add25 0x3a1d83a9 0x322a6857 0x3a1e0b6b 0x2f96f185 0x31ee933d 0x31eee7c7 0x3a1e0b6b 0x2f96f185 0x31ef0e11 0x3a6bad3f 0x3a6bd6c3 0x2fa09681 0x2fa07f4d 0x2f972769 0x2f97254b 0x348cf6d3 0x322d1891 0x233c79 0x3a6cfab7)Thread 0 Crashed:0 libsystem_kernel.dylib 0x3a7861f0 0x3a773000 + 783201 libsystem_pthread.dylib 0x3a7ee7b3 0x3a7eb000 + 142592 libsystem_c.dylib 0x3a736ff5 0x3a6ed000 + 3030933 libc++abi.dylib 0x39b8598b 0x39b85000 + 24434 libc++abi.dylib 0x39b9c1f5 0x39b85000 + 947095 libc++abi.dylib 0x39b9ba05 0x39b85000 + 926776 libobjc.A.dylib 0x3a1d1db7 0x3a1ce000 + 157997 CoreFoundation 0x2fa3ee49 0x2f96a000 + 8720098 XiaoYu 0x0054af05 0x10000 + 54842939 libsystem_platform.dylib 0x3a7e9719 0x3a7e6000 + 1410510 libsystem_pthread.dylib 0x3a7ee7b3 0x3a7eb000 + 1425911 libsystem_c.dylib 0x3a736ff5 0x3a6ed000 + 30309312 libsystem_malloc.dylib 0x3a7add21 0x3a7ab000 + 1155313 libobjc.A.dylib 0x3a1d83a5 0x3a1ce000 + 4189314 UIKit 0x322a6853 0x32263000 + 27656315 libobjc.A.dylib 0x3a1e0b67 0x3a1ce000 + 7664716 CoreFoundation 0x2f96f181 0x2f96a000 + 2086517 QuartzCore 0x31ee9339 0x31ede000 + 4588118 QuartzCore 0x31eee7c3 0x31ede000 + 6752319 libobjc.A.dylib 0x3a1e0b67 0x3a1ce000 + 7664720 CoreFoundation 0x2f96f181 0x2f96a000 + 2086521 QuartzCore 0x31ef0e0d 0x31ede000 + 7732522 libdispatch.dylib 0x3a6bad3d 0x3a6ba000 + 338923 libdispatch.dylib 0x3a6bd6bf 0x3a6ba000 + 1401524 CoreFoundation 0x2fa0967d 0x2f96a000 + 65292525 CoreFoundation 0x2fa07f49 0x2f96a000 + 64698526 CoreFoundation 0x2f972765 0x2f96a000 + 3466127 CoreFoundation 0x2f972547 0x2f96a000 + 3411928 GraphicsServices 0x348cf6cf 0x348c6000 + 3860729 UIKit 0x322d188d 0x32263000 + 45274930 XiaoYu 0x00233c75 0x10000 + 224370131 libdyld.dylib 0x3a6cfab5 0x3a6ce000 + 6837Thread 1:Thread 0 crashed with ARM Thread State (32-bit): r0: 0x00000000 r1: 0x00000000 r2: 0x00000000 r3: 0x00002060 r4: 0x00000006 r5: 0x3c42818c r6: 0x186e33b0 r7: 0x27df21b0 r8: 0x186e33b0 r9: 0x00000001 r10: 0x00000006 r11: 0x00000005 ip: 0x00000148 sp: 0x27df21a4 lr: 0x3a7ee7b7 pc: 0x3a7861f0 cpsr: 0x00000010Binary Images:","tags":[{"name":"iOS","slug":"ios","permalink":"http://yoursite.com/tags/ios/"}]},{"title":"iOS-MDMæµç¨‹è®°å½•","date":"2014-01-08T01:56:00.000Z","path":"2014/01/08/iOS-MDMæµç¨‹è®°å½•/","text":"MDMå¼€å‘æµç¨‹1.ç”³è¯·ä¼ä¸šå¼€å‘è€…è´¦å·ï¼Œè¿™ä¸€æ­¥æ¯”è¾ƒéº»çƒ¦çš„æ˜¯ç”³è¯·é‚“ç™½æ°ç ï¼Œå› ä¸ºè¦é€šè¿‡åå¤é‚“ç™½æ°é‚£è¾¹çš„å®¡æ ¸ã€‚æ‹–äº†æ¯”è¾ƒä¹…ã€‚2.æœ‰å¼€å‘è€…è´¦å·å°±å¯ä»¥åšMDMè¯ä¹¦äº†ï¼Œ ä¸»è¦å‚è€ƒ:mbaikesofthinker è¿™é‡Œè¦æ³¨æ„çš„æ˜¯12//Change to your alias æ˜¯ä½ è¯ä¹¦çš„åå­—ï¼String alias = \"MbaikeMDMCSR\"; mdmè¯ä¹¦åˆ¶ä½œ1.ç”¨appleé’¥åŒ™ä¸²è®¿é—®å·¥å…·ç”ŸæˆCertificateSigningRequest.certSigningRequest2.åˆ©ç”¨ç”Ÿæˆçš„å…¬ç§é’¥ä¸­çš„ç§é’¥å¯¼å‡ºä¸ºvendor.p122.ç™»é™†299ä¼ä¸šå¸å·åˆ›å»ºå¹¶ä¸‹è½½mdm.cer4.ä¸‹è½½AppleWWDRCA è¯ä¹¦5.ä¸‹è½½AppleIncRootCertificate è‹¹æœæ ¹è¯ä¹¦6.åˆ©ç”¨ä»¥ä¸‹å‘½ä»¤å°†cerè¯ä¹¦è½¬æˆè¯pemä¹¦123openssl x509 -inform der -in mdm.cer -out mdm.pemopenssl x509 -inform der -in AppleWWDRCA.cer -out intermediate.pemopenssl x509 -inform der -in AppleIncRootCertificate.cer -out root.pem 7.ç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦123openssl genrsa -des3 -out customerPrivateKey.pem 2048openssl req -new -key customerPrivateKey.pem -out customer.csropenssl req -inform pem -outform der -in customer.csr -out customer.der 8.åˆ©ç”¨MDMIOSGenerateEncodedPlist.javaç”Ÿæˆplist.xmlå’Œplist_encoded9.æ‰“å¼€ https://identity.apple.com/pushcert/ ç™»é™†ä»»æ„appleidå¸å·ï¼Œä¸Šä¼ plist_encodedæ–‡ä»¶ï¼Œç”³è¯·é€šè¿‡åï¼Œä¸‹è½½apns-mdm.pemè¯ä¹¦10.å°†apns-mdm.pemä¸customerPrivateKey.pemåˆå¹¶ä¸ºapns-mdm.p121openssl pkcs12 -export -inkeycustomerPrivateKey.pem -in apns-mdm.pem -out apns-mdm.p12 æ­¤apns-mdm.p12å°±æ˜¯mdmæœåŠ¡å™¨å’Œè‹¹æœanpsæœåŠ¡å™¨é€šè®¯ç”¨çš„p12ä¹Ÿæ˜¯mobileconfä¸­ç»‘å®šçš„p12(mobileconfæœ€ç»ˆå®‰è£…åœ¨ç§»åŠ¨è®¾å¤‡ä¸Š) MDMplist 3.ç”³è¯·æœåŠ¡å™¨æ‰€éœ€è¯ä¹¦ 4.éƒ¨ç½²https(SSL)æœåŠ¡å™¨ç¯å¢ƒ æœ€å¥½åšä¸‹åŸŸåæ˜ å°„ï¼ 5.é…ç½®æè¿°æ–‡ä»¶mobileconfigçš„ç”Ÿæˆ ä¸‹è½½iPhoneé…ç½®å®ç”¨å·¥å…·ï¼Œé…ç½®é€šç”¨å’Œç§»åŠ¨è®¾å¤‡ç®¡ç†æ³¨æ„ï¼šaï¼šTopic must be com.apple.mgmt. bï¼šé€šç”¨çš„å®‰å…¨æ€§ä¸ºæ€»æ˜¯ cï¼šç§»åŠ¨è®¾å¤‡ç®¡ç†ä¸­çš„ä½¿ç”¨å¼€å‘APNSæœåŠ¡å™¨ä¸èƒ½å‹¾é€‰ ä¸»è¦å‚è€ƒï¼š(http://www.mbaike.net/ios/1560.html) å¯¼å‡ºï¼ˆé€‰â€œæ— â€ï¼‰åç­¾å 1openssl smime -sign -in unsigned.mobileconfig -out signed.mobileconfig -signer mbaike.crt -inkey mbaike.key -certfile ca-bundle.pem -outform der -nodetach","tags":[{"name":"iOS MDM","slug":"ios-mdm","permalink":"http://yoursite.com/tags/ios-mdm/"}]},{"title":"Markdownè¯­æ³•è¯´æ˜","date":"2011-12-20T09:52:09.000Z","path":"2011/12/20/Markdownè¯­æ³•è¯´æ˜/","text":"æ ‡é¢˜ï¼š #h1çº§æ ‡é¢˜ ##h2çº§æ ‡é¢˜ ###h3çº§æ ‡é¢˜ ####h4çº§æ ‡é¢˜ #####h5çº§æ ‡é¢˜ ######h6çº§æ ‡é¢˜ åˆ†å‰²çº¿ï¼šä¸‰ä¸ªä»¥ä¸Šçš„çŸ­çº¿ å³å¯ä½œå‡ºåˆ†å‰²çº¿ è¶…é“¾æ¥ï¼šè¿æ¥åç§°æˆ‘æ˜¯é“¾æ¥å ç‚¹æˆ‘åˆ·æ–° å¦ä¸€ç§è¶…é“¾æ¥å†™æ³•ï¼š[é“¾æ¥å][é“¾æ¥ä»£å·]hereç„¶ååœ¨åˆ«çš„åœ°æ–¹å®šä¹‰ 3 è¿™ä¸ªè¯¦ç»†é“¾æ¥ä¿¡æ¯ï¼Œ ç›´æ¥å±•ç¤ºé“¾æ¥çš„å†™æ³•ï¼šhttp://www.izhangbo.cn é”®ç›˜é”®Ctrl+[ and Ctrl+] codeæ ¼å¼ï¼šåå¼•å·Use the printf() function. There is a literal backtick (`) here.é’ˆå¯¹åœ¨ä»£ç åŒºæ®µå†…æ’å…¥åå¼•å·çš„æƒ…å†µ å¼ºè°ƒï¼šæ–œä½“å¼ºè°ƒç²—ä½“å¼ºè°ƒ å›¾ç‰‡ ä½¿ç”¨ icon å›¾æ ‡æ–‡å­— æ®µè½ï¼šä»¥ä¸€ä¸ªç©ºè¡Œå¼€å§‹ï¼Œä»¥ä¸€ä¸ªç©ºè¡Œç»“æŸï¼Œä¸­é—´çš„å°±æ˜¯ä¸€ä¸ªæ®µè½ã€‚ è¡¨æ ¼ï¼š Item Value Computer $1600 Phone $12 Pipe $1 æ— åºåˆ—è¡¨ï¼šä½¿ç”¨ - åŠ ä¸€ä¸ªç©ºæ ¼ï¼ˆï¼‰ æ— éœ€åˆ—è¡¨1 æ— åºåˆ—è¡¨2 æ— åºåˆ—è¡¨3 æœ‰åºåˆ—è¡¨ï¼šä½¿ç”¨ æ•°å­— åŠ ä¸€ä¸ªè‹±æ–‡å¥ç‚¹ æœ‰åºåˆ—è¡¨ æœ‰åºåˆ—è¡¨ æœ‰åºåˆ—è¡¨ æœ‰åºåˆ—è¡¨ æœ‰åºåˆ—è¡¨ æ¢è¡Œç¼©è¿›å½¢æˆä»£ç åŒºå— è¿™é‡Œå…ˆæ¢è¡Œï¼Œç„¶åç¼©è¿›4ä¸ªç©ºæ ¼ï¼Œä¹‹åçš„å†…å®¹ä¾¿å¯ä»¥åŸæ ·æ˜¾ç¤ºäº†ï¼Œé€‚åˆç”¨äºæ˜¾ç¤ºä»£ç å†…å®¹ã€‚ç›´åˆ°æ–‡æœ¬ç»“æŸæˆ–æœ€åä¸€ä¸ªå­˜åœ¨ç¼©è¿›çš„è¡Œä¸ºæ­¢ã€‚ å—å¼•ç”¨ ç»™å¼•ç”¨çš„æ–‡æœ¬å¼€å§‹ä½ç½®éƒ½åŠ ä¸€ä¸ª â€˜&gt;â€™ï¼Œä¾¿å¯ç»„æˆä¸€ä¸ªå—å¼•ç”¨ã€‚åœ¨å—å¼•ç”¨ä¸­ï¼Œå¯ä»¥ç»“åˆå…¶ä»–markdownå…ƒç´ ä¸€å—ä½¿ç”¨ï¼Œæ¯”å¦‚åˆ—è¡¨ã€‚å¼ºè°ƒä¹Ÿå¯ä»¥åªåœ¨ç¬¬ä¸€è¡ŒåŠ å¤§äºå·ï¼Œå…¶ä»–ä½ç½®ä¸åŠ ã€‚ å—å¼•ç”¨é‡Œä½¿ç”¨åˆ—è¡¨ï¼Œéœ€è¦å’Œä¸Šé¢çš„å†…å®¹éš”å¼€ä¸€ä¸ªç©ºè¡Œ è®°å¾—åŠ ç©ºæ ¼å“¦ã€‚","tags":[]},{"title":"playGroud","date":"2011-12-16T06:25:32.000Z","path":"2011/12/16/playgroud/","text":"( âŠ™ o âŠ™ )å•Šï¼ â€“å¼•ç”¨å— Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque hendrerit lacus ut purus iaculis feugiat. Sed nec tempor elit, quis aliquam neque. Curabitur sed diam eget dolor fermentum semper at eu lorem. Do not just seek happiness for yourself. Seek happiness for all. Through kindness. Through mercy. David LevithanWide Awake NEW: DevDocs now comes with syntax highlighting. http://devdocs.io @DevDocstwitter.com/devdocs/status/356095192085962752 Every interaction is both precious and an opportunity to delight. Seth GodinWelcome to Island Marketing â€“ä»£ç å—1alert(&apos;Hello World!&apos;); 1[rectangle setX: 10 y: 10 width: 20 height: 20]; Array.map1array.map(callback[, thisArg]) _.compactUnderscore.js12_.compact([0, 1, false, 2, &apos;&apos;, 3]);=&gt; [1, 2, 3] åå¼•å·ä»£ç å—å¦ä¸€ç§å½¢å¼çš„ä»£ç å—ï¼Œä¸åŒçš„æ˜¯å®ƒä½¿ç”¨ä¸‰ä¸ªåå¼•å·æ¥åŒ…è£¹ã€‚ [language] [title] [url] [link text] code snippetPull Quoteåœ¨æ–‡ç« ä¸­æ’å…¥ Pull quoteã€‚ content jsFiddleåœ¨æ–‡ç« ä¸­åµŒå…¥ jsFiddleã€‚ Giståœ¨æ–‡ç« ä¸­åµŒå…¥ Gistã€‚ iframeåœ¨æ–‡ç« ä¸­æ’å…¥ iframeã€‚ Imageåœ¨æ–‡ç« ä¸­æ’å…¥æŒ‡å®šå¤§å°çš„å›¾ç‰‡ã€‚ ğŸ˜ Linkåœ¨æ–‡ç« ä¸­æ’å…¥é“¾æ¥ï¼Œå¹¶è‡ªåŠ¨ç»™å¤–éƒ¨é“¾æ¥æ·»åŠ  target=â€_blankâ€ å±æ€§ã€‚ text url [external] [title] Include Codeæ’å…¥ source æ–‡ä»¶å¤¹å†…çš„ä»£ç æ–‡ä»¶ã€‚ Youtubeåœ¨æ–‡ç« ä¸­æ’å…¥ Youtube è§†é¢‘ã€‚ Vimeoåœ¨æ–‡ç« ä¸­æ’å…¥ Vimeo è§†é¢‘ã€‚ å¼•ç”¨æ–‡ç« å¼•ç”¨å…¶ä»–æ–‡ç« çš„é“¾æ¥ã€‚ å¼•ç”¨èµ„æºå¼•ç”¨æ–‡ç« çš„èµ„æºã€‚ Rawå¦‚æœæ‚¨æƒ³åœ¨æ–‡ç« ä¸­æ’å…¥ Swig æ ‡ç­¾ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ Raw æ ‡ç­¾ï¼Œä»¥å…å‘ç”Ÿè§£æå¼‚å¸¸ã€‚ content","tags":[{"name":"tag1","slug":"tag1","permalink":"http://yoursite.com/tags/tag1/"}]},{"title":"Luaå†…å­˜ç®¡ç†","date":"2011-07-04T07:55:00.000Z","path":"2011/07/04/Luaå†…å­˜ç®¡ç†/","text":"æœ¬æ–‡ä¸»è¦ä»‹ç»æŸé¡¹ç›®è„šæœ¬(lua)éƒ¨åˆ†å†…å­˜æ³„æ¼çš„æŸ¥è¯ä¸å¤„ç†è¿‡ç¨‹ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰ç‚¹å¸®åŠ©ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œluaæœ¬èº«å¹¶ä¸å­˜åœ¨çœŸæ­£çš„å†…å­˜æ³„æ¼ï¼Œåªæ˜¯å› ä¸ºä½¿ç”¨ä¸Šé¢çš„åŸå› å¯¼è‡´æ— æ³•gcï¼Œä»è€Œå¯¼è‡´é€»è¾‘ä¸Šçš„æ³„æ¼:)ã€‚ å‚è€ƒGCObjectçš„å£°æ˜å¯ä»¥å‘ç°ï¼Œluaä¸­çš„å¤æ‚æ•°æ®ç±»å‹å˜é‡çš„ä¼ é€’éƒ½æ˜¯åŸºäºå¼•ç”¨çš„ã€‚å½“luaä»æ ¹å¼€å§‹gcæ‰«æçš„æ—¶å€™ï¼Œåªè¦è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹æœ‰å¯¹æ­¤å˜é‡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±ä¸ä¼šè¢«collectã€‚è¿™ç§æƒ…å†µé€ æˆçš„å±å®³å–å†³äºå¤šå¤§ç¨‹åº¦ä¸Šä¾èµ–äºå¼•ç”¨ï¼Œå¦‚æœæœ‰é€‚å½“çš„é—´æ¥å±‚/å¼±å¼•ç”¨æ¥éš”ç¦»è¿™ä¸ªé—®é¢˜ï¼Œå¯èƒ½é—®é¢˜ä¼šæœ‰æ‰€ç¼“è§£ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„é”™è¯¯å¼•ç”¨æƒ…æ™¯: 1.æœ¬åº”è¯¥local çš„å˜é‡è¿›å…¥globalç©ºé—´æˆ–è€…moduleç©ºé—´äº†(å¿˜è®°å†™local)ï¼Œå¦‚æœè¿™æ˜¯ä¸€ä¸ªtable/function/udataç­‰ç±»å‹çš„å˜é‡çš„è¯ï¼Œéå¸¸ä¸å¹¸çš„ï¼Œè¿™ä¸ªå˜é‡å°†ä¸ä¼šè¢«æ­£ç¡®gcäº† â€”-é™¤éä½ å†æ˜¾å¼çš„é‡Šæ”¾ã€‚è¿™æ˜¯éå¸¸å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼Œä¸€ç›´åœ¨æƒ³ä¸ºä»€ä¹ˆluaå˜é‡ä¸æ˜¯é»˜è®¤localå‘¢ï¼Ÿ å½“ç„¶è¿™ä¸ªè¯é¢˜ä¼šå¼•å‘å¦å¤–ä¸€åœºäº‰è®ºã€‚ 1234local function test_user(id) userobj = get_user_by_id(id) --è¿™é‡Œæ€»æ˜¯ä¼šæœ‰ä¸€ä¸ªç©å®¶å¯¹è±¡æ³„æ¼ print(\"only test\", userobj:get_name())end 2.c/c++éƒ¨åˆ†è°ƒç”¨çš„lua_refæ˜¯å¦æœ‰æ­£å¸¸lua_unrefé‡Šæ”¾ï¼Ÿ é€šè¿‡debug.getregistry()å¯ä»¥æŸ¥åˆ°è¿™äº›ref. 3.å…¶ä»–å„ç§å„æ ·çš„å®é™…bugé€ æˆçš„æ³„æ¼ã€‚ å½“æ€€ç–‘ç³»ç»Ÿæœ‰æ³„æ¼ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥æ€ä¹ˆæŸ¥åˆ°è¿™äº›æ³„æ¼å‘¢ï¼Ÿæˆ‘å¼ºçƒˆå»ºè®®å¤§å®¶å»ºç«‹ä¸€ä¸ªweak table, æŠŠä½ æ‰€æœ‰åˆ›å»ºè¿‡çš„èƒ½å¤Ÿç§°ä¹‹ä¸ºèµ„æºçš„ï¼ŒåŒ…å«ä½†ä¸é™äºâ€œæˆ˜æ–—å¯¹è±¡ï¼Œç©å®¶ï¼Œnpcï¼Œç‰©å“ï¼Œåœºæ™¯ï¼Œé‚®ä»¶â€ç­‰ç­‰å¯¹è±¡å…¨éƒ¨æ‰”åˆ°è¿™ä¸ªtableé‡Œé¢ã€‚å½“ä½ çŸ¥é“ç©å®¶å·²ç»ä¸‹çº¿ã€æˆ˜æ–—å·²ç»é”€æ¯äº†ï¼Œä½†é€šè¿‡è¿ç»­çš„å¼ºåˆ¶full gcä»¥åweak tableé‡Œé¢è¿˜æœ‰è¿™ä¸ªå˜é‡ï¼Œè¿™å°±è¯æ˜äº†è¿™ä¸ªå˜é‡çš„å¼•ç”¨æ²¡æœ‰è¢«å®Œå…¨é‡Šæ”¾ï¼Œäºæ˜¯é—®é¢˜å°±è¢«å‘ç°äº†ï¼Œæˆ‘ä»¬åˆæœ‰äº‹æƒ…å¹²äº†@_@ã€‚ çŸ¥é“æœ‰æ³„æ¼æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ï¼Œèƒ½å¤Ÿå®Œå…¨æªå‡ºæ¥å°±ä¸æ˜¯å¾ˆå®¹æ˜“äº†ã€‚æ˜¯çš„ï¼Œå®ƒç©¶ç«Ÿåœ¨å“ªå„¿å‘¢? ä¸€å¼€å§‹åœ¨æ­¤é¡¹ç›®é‡Œé¢ä¹Ÿæ˜¯å…ˆå‘ç°æ¯”å¦‚æŸnpcæ³„æ¼äº†ï¼Œç„¶åå°±å»æŸ¥ä»£ç ï¼Œçœ‹çœ‹ç©¶ç«Ÿå“ªä¸ªåœ°æ–¹å†™å¾—ä¸å¯¹ã€‚è¿™ç§æ–¹å¼æ•ˆç‡æä½ï¼ŒåŸºæœ¬ä¸ŠæŸ¥ä¸åˆ°ä»€ä¹ˆé—®é¢˜ã€‚åœ¨è¿Ÿä¸€ç‚¹çš„æ—¶å€™æ‰ä½¿ç”¨ç°åœ¨çš„æ–¹æ¡ˆï¼šä»_Gæ·±åº¦éå†æ‰€æœ‰çš„tableã€metatableã€funcitonâ€™supvalueã€functionâ€™s envã€registentry(lua_ref)ã€‚ ç›®å‰æ‰€çŸ¥çš„æ‰€æœ‰å¼•ç”¨å¿…å®šå­˜åœ¨äºè¿™å‡ ä¸ªç©ºé—´ï¼Œ éå†å®Œæˆä»¥åä¸€å®šå¯ä»¥æ‰¾åˆ°é‚£ä¸ªâ€œè¿·å¤±äº†çš„å¼•ç”¨â€ã€‚ è¿™ç§æ–¹å¼åœ¨è„šæœ¬å±‚å°±å¯ä»¥å®Œæˆæ‰€æœ‰äº‹æƒ…ï¼Œç”šè‡³ä½ å¯ä»¥åœ¨è¿è¥ç¯å¢ƒä¸­åœ¨çº¿æŸ¥è¯ï¼Œå…¶éå†çš„é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ï¼Œä½†å†…å­˜å¼€é”€éå¸¸å¤§(:ï¼Œå¯ä»¥è€ƒè™‘ä¸€è¾¹éå†ä¸€è¾¹gcï¼Œå½“ç„¶è¿˜è¦è®°å¾—é¿å…é‡å¤æœç´¢ã€‚ åœ¨åº”ç”¨æ­¤æ–¹æ¡ˆä»¥åï¼Œæ­¤é¡¹ç›®è§£å†³äº†è„šæœ¬ä¸­æ‰€æœ‰çš„æ³„æ¼é—®é¢˜ã€‚ ä¸€ç‚¹æ€»ç»“ï¼š1.å¦‚æœç³»ç»Ÿæ€§èƒ½è¿˜èƒ½å¤Ÿæ‰¿å—çš„è¯ï¼Œå»ºè®®ä¸è¦ç›´æ¥å¼•ç”¨å¯¹è±¡ï¼Œå¯ä»¥å¤šåšä¸€å±‚é—´æ¥å±‚ã€‚2.luaé‡Œé¢çš„å¼±å¼•ç”¨æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚3.æ¯”è¾ƒå¤§çš„ç‰©ç†å†…å­˜æ˜¯å¿…è¦çš„ï¼Œè¿™å¯ä»¥ä¸ºå¤§å®¶æŸ¥è¯é—®é¢˜äº‰å–è¶³å¤Ÿå¤šçš„æ—¶é—´:) 4.å¯ä»¥æŠŠæŸ¥æ‰¾æ³„æ¼çš„éƒ¨åˆ†å†™å…¥åˆ°å…³æœºé€»è¾‘é‡Œé¢ï¼Œæ¯æ¬¡å…³æœºçš„æ—¶å€™è‡ªåŠ¨æŸ¥æ‰¾æ³„æ¼ï¼Œç„¶åå‡ºå…·æŠ¥å‘Šã€‚","tags":[{"name":"Lua","slug":"lua","permalink":"http://yoursite.com/tags/lua/"}]}]